from spade.behaviour import OneShotBehaviour
from spade.agent import Agent

class NmapAgent(Agent):
    class NmapScanning(OneShotBehaviour):
        async def on_start(self):
            print("Nmap agent started")
        
        async def run(self):
            #TODO use nmap to do the scan
            print("agent is running, targeting the {}".format(self.target))
            #TODO send message to the other agents that the job is finsihed / send the results
        
        async def on_end(self):
            print("Nmap scan is done")

        def set_scan_target(self, target_address):
            self.target = target_address

    async def setup(self):
        self.agent_behaviour = self.NmapScanning()
        self.agent_behaviour.set_scan_target(self.target)
        self.add_behaviour(self.agent_behaviour)
    
    def set_target(self, target_address):
        self.target = target_address