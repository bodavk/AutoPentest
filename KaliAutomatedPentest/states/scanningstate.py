from spade.behaviour import State
from agents.nmapagent import NmapAgent

EXPLOIT_STATE="EXPLOIT_STATE" #Exploatation state

class ScanningState(State):
    async def run(self):
        print("Starting the scanner state")  
        nmap_agent = NmapAgent("nmap@localhost", "supersecret")
        nmap_agent.set_target(self.target)
        #await nmap_agent.start()
        await nmap_agent._async_start(auto_register=True)
        self.set_next_state(EXPLOIT_STATE)
    
    def set_target(self, target_address):
        self.target = target_address