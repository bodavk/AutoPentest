import nmap

class Scanner(object):
    def Scan(self, target_address):
        options = "-T4 -A -v" 
        #intense scan option in zenmap, change these two settings as necessary 
        #TODO test will it work with script scan -sC
        ports = "1-1024"
        nmap_scan_result = self._scan_target_nmap(target_address, options, ports)
        return nmap_scan_result

    def _scan_target_nmap(self, target_address, options, port_range):
        nm = nmap.PortScanner() #initialize the portscanner
        nm.scan(target_address, port_range)
        scan_result = nm.csv()
        return scan_result